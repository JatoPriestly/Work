(()=>{var e={};e.id=555,e.ids=[555],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},44089:(e,r,t)=>{"use strict";t.d(r,{uQ:()=>p,On:()=>c,Fv:()=>i,Gf:()=>u,$T:()=>l,Y$:()=>n,tO:()=>d});var s=t(34717),o=t(53517);function a(e){let r;let t=new Date;if(e.always_active)return{valid:!0,qrCode:e,mode:"sign_in",message:"QR code is always active"};let s=e.week_start.toDate(),o=e.week_end.toDate();if(t<s||t>o)return{valid:!1,message:"QR code has expired",qrCode:e};let a=e.work_days.split(","),i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()];if(!a.includes(i))return{valid:!1,message:"QR code is not active on this day",qrCode:e};let n=100*t.getHours()+t.getMinutes(),c=Number.parseInt(e.signin_hour.replace(":","")),d=Number.parseInt(e.inactive_hour.replace(":","")),u=Number.parseInt(e.signout_hour.replace(":",""));return"inactive"==(r=n>=c&&n<d?"sign_in":n>=d&&n<u?"sign_out":"inactive")?{valid:!1,message:"QR code is not active at this time",qrCode:e}:{valid:!0,qrCode:e,mode:r,message:`Ready for ${"sign_in"===r?"sign in":"sign out"}`}}async function i(e){try{let r=(0,s.rJ)(o.db,"employees"),t=(0,s.P)(r,(0,s._M)("employee_id","==",e)),a=await (0,s.GG)(t);if(a.empty)return null;return{id:a.docs[0].id,...a.docs[0].data()}}catch(e){throw console.error("[v0] Error getting employee by ID:",e),e}}async function n(e,r){try{let t=(0,s.H9)(o.db,"employees",e);return await (0,s.mZ)(t,r),{success:!0}}catch(e){throw console.error("[v0] Error updating employee:",e),e}}async function c(){try{let e=(0,s.rJ)(o.db,"qr_codes"),r=(0,s.P)(e,(0,s.AB)(1)),t=await (0,s.GG)(r);if(console.log("getCurrentQRCode: querySnapshot.empty:",t.empty),console.log("getCurrentQRCode: querySnapshot.docs:",t.docs.map(e=>e.data())),t.empty)return console.log("getCurrentQRCode: No active QR code found in database."),{valid:!1,message:"No active QR code found"};let i={id:t.docs[0].id,...t.docs[0].data()},n=a(i);return console.log("getCurrentQRCode: Validation result:",n),{...n,qrCode:i}}catch(e){return console.error("[v0] Error getting current QR code:",e),{valid:!1,message:"Error validating QR code"}}}async function d(e){try{let r=(0,s.rJ)(o.db,"qr_codes"),t=(0,s.P)(r,(0,s._M)("code","==",e),(0,s._M)("is_active","==",!0)),i=await (0,s.GG)(t);if(i.empty)return{valid:!1,message:"Invalid or expired QR code"};let n={id:i.docs[0].id,...i.docs[0].data()};return a(n)}catch(e){return console.error("[v0] Error validating QR code:",e),{valid:!1,message:"Error validating QR code"}}}async function u(e){try{let r=(0,s.rJ)(o.db,"signin_out_records"),t={employee_id:e.employee_id,qr_code_id:e.qrCodeId,action_type:e.actionType,timestamp:s.Dc.now(),ip_address:e.ipAddress||"",device_info:e.deviceInfo||"",selfie_data:e.selfieData||""};return{lastID:(await (0,s.gS)(r,t)).id}}catch(e){throw console.error("[v0] Error recording sign in/out:",e),e}}async function p(e){try{let r=(0,s.H9)(o.db,"qr_codes",e);return await (0,s.kd)(r),{success:!0}}catch(e){throw console.error("[v0] Error deleting QR code:",e),e}}async function l(e,r){try{let t=(0,s.H9)(o.db,"qr_codes",e);return await (0,s.mZ)(t,{is_active:!r}),{success:!0}}catch(e){throw console.error("[v0] Error toggling QR code status:",e),e}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},53517:(e,r,t)=>{"use strict";t.d(r,{db:()=>c,j2:()=>d});var s=t(89579),o=t(34717),a=t(6333),i=t(1767);let n=(0,s.Wp)({apiKey:"AIzaSyAKy32t3h5bIC0T--o56m982hmeFBEbk0U",authDomain:"martinez-4ab8d.firebaseapp.com",projectId:"martinez-4ab8d",storageBucket:"martinez-4ab8d.firebasestorage.app",messagingSenderId:"79056089461",appId:"1:79056089461:web:e25bb5bf9b462e83ebe33c",measurementId:"G-W17EK3Z35K"}),c=(0,o.aU)(n);(0,a.c7)(n);let d=(0,i.xI)(n)},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},92190:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>y,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{DELETE:()=>d,PUT:()=>u});var o=t(96559),a=t(48088),i=t(37719),n=t(32190),c=t(44089);async function d(e,r){try{let{id:e}=r.params;return await (0,c.uQ)(e),n.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting QR code:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}async function u(e,r){try{let{id:t}=r.params,{currentStatus:s}=await e.json();return await (0,c.$T)(t,s),n.NextResponse.json({success:!0})}catch(e){return console.error("Error toggling QR code status:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/qr/[id]/route",pathname:"/api/qr/[id]",filename:"route",bundlePath:"app/api/qr/[id]/route"},resolvedPagePath:"/home/hack237/Pictures/Work/app/api/qr/[id]/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:g,serverHooks:y}=p;function m(){return(0,i.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:g})}},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,580,129],()=>t(92190));module.exports=s})();